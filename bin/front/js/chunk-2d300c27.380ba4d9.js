(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d300c27"],{"063d":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Row",[r("Card",[r("p",{staticStyle:{height:"45px"},attrs:{slot:"title"},slot:"title"},[r("Icon",{attrs:{type:"android-send"}}),t._v("\n        工单"+t._s(this.$route.query.workid)+"详细信息\n        "),r("br"),"1"===this.$route.query.status?r("Button",{attrs:{type:"text"},nativeOn:{click:function(e){return t.rollback()}}},[t._v("查看回滚语句")]):"0"===this.$route.query.status||"4"===this.$route.query.status?r("Button",{attrs:{type:"text"},nativeOn:{click:function(e){return t.repairOrder()}}},[t._v("重新提交\n        ")]):t._e(),r("Button",{attrs:{type:"text"},nativeOn:{click:function(e){return t.$router.go(-1)}}},[t._v("返回")])],1),r("Row",[r("Col",{attrs:{span:"24"}},[r("Table",{staticClass:"tabletop",staticStyle:{background:"#5cadff"},attrs:{border:"",columns:t.columns,data:t.TableDataNew,size:"large"}}),r("br"),r("Page",{ref:"page",attrs:{total:t.page_number,"show-elevator":"","page-size":20},on:{"on-change":t.current_page}})],1)],1)],1)],1),r("BackTop",{attrs:{height:100,bottom:200}},[r("div",{staticClass:"top"},[t._v("返回顶端")])]),r("Modal",{attrs:{"ok-text":"提交工单",width:"800"},on:{"on-ok":t.referOrder},model:{value:t.reload_sql,callback:function(e){t.reload_sql=e},expression:"reload_sql"}},[r("div",{staticClass:"step-header-con"},[r("h3",[t._v("Yearning SQL平台审核工单")])]),r("p",{staticClass:"step-content"}),r("Form",{staticClass:"step-form"},[r("FormItem",{attrs:{label:"用户名:"}},[r("p",[t._v(t._s(t.formItem.Username))])]),r("FormItem",{attrs:{label:"环境:"}},[r("p",[t._v(t._s(t.formItem.IDC))])]),r("FormItem",{attrs:{label:"连接名:"}},[r("p",[t._v(t._s(t.formItem.Source))])]),r("FormItem",{attrs:{label:"数据库库名:"}},[r("p",[t._v(t._s(t.formItem.DataBase))])]),r("FormItem",{attrs:{label:"定时执行:"}},[r("p",[t._v(t._s(t.formItem.Delay))])]),r("FormItem",["0"===this.$route.query.status||"4"===this.$route.query.status?r("Input",{attrs:{type:"textarea"},model:{value:t.formItem.SQL,callback:function(e){t.$set(t.formItem,"SQL",e)},expression:"formItem.SQL"}}):t._e(),"1"===this.$route.query.status?r("Table",{attrs:{columns:t.rollColumn,data:t.rollData,"max-height":"300"}}):t._e()],1),r("FormItem",{attrs:{label:"工单提交说明:"}},[r("Input",{attrs:{placeholder:"最多不超过20个字"},model:{value:t.formItem.text,callback:function(e){t.$set(t.formItem,"text",e)},expression:"formItem.text"}})],1),r("FormItem",{attrs:{label:"是否备份"}},[r("RadioGroup",{model:{value:t.formItem.Backup,callback:function(e){t.$set(t.formItem,"Backup",e)},expression:"formItem.Backup"}},[r("Radio",{attrs:{label:1}},[t._v("是")]),r("Radio",{attrs:{label:0}},[t._v("否")])],1)],1)],1)],1)],1)},o=[],n=(r("6b54"),r("2397"),r("d225")),c=r("4e2b"),i=r("308d"),s=r("6bb5"),u=(r("ac6a"),r("b0b4")),l=r("9ab4"),f=r("60a3"),m=r("c622"),p=r("bc3a"),d=r.n(p),h=r("15fd");function b(t){var e=v();return function(){var r,a=Object(s["a"])(t);if(e){var o=Object(s["a"])(this).constructor;r=Reflect.construct(a,arguments,o)}else r=a.apply(this,arguments);return Object(i["a"])(this,r)}}function v(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var y=function(t){Object(c["a"])(r,t);var e=b(r);function r(){var t;return Object(n["a"])(this,r),t=e.apply(this,arguments),t.columns=[{title:"sql语句",key:"SQL"},{title:"状态",key:"State"},{title:"错误信息",key:"Error",tooltip:!0},{title:"影响行数",key:"Affectrow",width:100},{title:"执行时间/秒",key:"Time"}],t.TableDataNew=[],t.reload_sql=!1,t.formItem={},t.rollColumn=[{type:"expand",width:50,render:function(t,e){return t(m["a"],{props:{row:e.row.SQL}})}},{title:"当前检查的sql",key:"SQL",render:function(t,e){var r=e.row.SQL.substring(0,80);return r.length>80&&(r+="..."),t("span",r)}}],t.rollData=[],t}return Object(u["a"])(r,[{key:"rollback",value:function(){var t=this;d.a.get("".concat(this.$config.url,"/fetch/roll?workid=").concat(this.$route.query.workid)).then((function(e){e.data.sql!==[]?(t.reload_sql=!0,t.formItem=e.data.order,t.rollData=e.data.sql,t.formItem.Delay="none"):t.$config.err_notice(t,"无sql回滚语句")})).catch((function(e){t.$config.err_notice(t,e)}))}},{key:"repairOrder",value:function(){var t=this;d.a.get("".concat(this.$config.url,"/fetch/roll?workid=").concat(this.$route.query.workid)).then((function(e){t.formItem=e.data.order,t.formItem.Delay="none"})).catch((function(e){t.$config.err_notice(t,e)})),this.reload_sql=!0}},{key:"referOrder",value:function(){var t=this;if("1"===this.$route.query.status){var e="";this.rollData.forEach((function(t){e+=t.SQL})),this.formItem.SQL=e}d.a.post("".concat(this.$config.url,"/fetch/rollorder"),{data:this.formItem}).then((function(){t.$config.notice("工单已提交成功")})).catch((function(e){t.$config.err_notice(t,e)}))}},{key:"current_page",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;d.a.get("".concat(this.$config.url,"/fetch/detail?workid=").concat(this.$route.query.workid,"&status=").concat(this.$route.query.status,"&page=").concat(e)).then((function(e){t.TableDataNew=e.data.record,t.page_number=e.data.count})).catch((function(e){t.$config.err_notice(t,e)}))}},{key:"mounted",value:function(){this.current_page()}}]),r}(Object(f["b"])(h["a"]));y=Object(l["a"])([Object(f["a"])({components:{}})],y);var _,g,k=y;function O(t){var e=I();return function(){var r,a=Object(s["a"])(t);if(e){var o=Object(s["a"])(this).constructor;r=Reflect.construct(a,arguments,o)}else r=a.apply(this,arguments);return Object(i["a"])(this,r)}}function I(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var w=(_=Object(f["a"])({components:{},mixins:[k]}),_(g=function(t){Object(c["a"])(r,t);var e=O(r);function r(){return Object(n["a"])(this,r),e.apply(this,arguments)}return r}(f["d"]))||g),$=w,j=(r("8f88"),r("2877")),q=Object(j["a"])($,a,o,!1,null,null,null);e["default"]=q.exports},"8f88":function(t,e,r){"use strict";r("aeba")},aeba:function(t,e,r){},c622:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("code",[t._v(t._s(t.row))])},o=[],n=(r("6b54"),r("2397"),r("d225")),c=r("4e2b"),i=r("308d"),s=r("6bb5"),u=r("9ab4"),l=r("60a3"),f=r("a897"),m=r("15fd");function p(t){var e=d();return function(){var r,a=Object(s["a"])(t);if(e){var o=Object(s["a"])(this).constructor;r=Reflect.construct(a,arguments,o)}else r=a.apply(this,arguments);return Object(i["a"])(this,r)}}function d(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var h=function(t){Object(c["a"])(r,t);var e=p(r);function r(){return Object(n["a"])(this,r),e.apply(this,arguments)}return r}(Object(l["b"])(m["a"]));Object(u["a"])([Object(l["c"])({type:String,required:!0,default:""})],h.prototype,"row",void 0),h=Object(u["a"])([Object(l["a"])({components:{editor:f["a"]}})],h);var b=h,v=b,y=r("2877"),_=Object(y["a"])(v,a,o,!1,null,"f18b056c",null);e["a"]=_.exports}}]);
//# sourceMappingURL=chunk-2d300c27.380ba4d9.js.map