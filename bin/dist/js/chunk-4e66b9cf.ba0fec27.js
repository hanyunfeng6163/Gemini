(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e66b9cf"],{"09f7":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Modal",{attrs:{width:500,transfer:"","z-index":9999},on:{"on-ok":e.change_password},model:{value:e.open,callback:function(t){e.open=t},expression:"open"}},[r("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[e._v("修改密码")]),r("Form",{ref:"editPasswordForm",attrs:{model:e.form,"label-width":100,"label-position":"right",rules:e.validate_form}},[r("FormItem",{attrs:{label:"用户"}},[r("Input",{attrs:{readonly:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),r("FormItem",{attrs:{label:"新密码",prop:"password"}},[r("Input",{attrs:{placeholder:"请输入新密码，至少6位字符",type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),r("FormItem",{attrs:{label:"确认新密码",prop:"confirm"}},[r("Input",{attrs:{placeholder:"请再次输入新密码",type:"password"},model:{value:e.form.confirm,callback:function(t){e.$set(e.form,"confirm",t)},expression:"form.confirm"}})],1)],1)],1)},s=[],o=r("bc3a"),n=r.n(o),i={name:"edit_password",props:{is_open:Boolean,username:String,is_admin:Boolean},computed:{open:{get:function(){return this.is_open},set:function(){this.$emit("cancel")}}},data:function(){var e=this,t=function(t,r,a){r!==e.form.password?a(new Error("两次输入密码不一致")):a()};return{form:{old_password:"",password:"",confirm:""},validate_form:{old_password:[{required:!0,message:"请输入原密码",trigger:"blur"}],password:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"请至少输入6个字符",trigger:"blur"},{max:32,message:"最多输入32个字符",trigger:"blur"}],confirm:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:t,trigger:"blur"}]}}},methods:{change_password:function(){var e=this,t="user/password_reset";this.$refs["editPasswordForm"].validate((function(r){r&&(e.is_admin&&(t="management_user/password_reset"),n.a.post("".concat(e.$config.url,"/").concat(t),{username:e.form.username,new:e.form.password}).then((function(t){e.$config.notice(t.data)})).catch((function(t){e.$config.err_notice(e,t)})))})),this.$config.clearObj(this.form)}}},l=i,u=r("2877"),c=Object(u["a"])(l,a,s,!1,null,"b4156d8c",null);t["a"]=c.exports},"4fb4":function(e,t,r){"use strict";r("8713")},"742b":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Col",{attrs:{span:"5"}},[r("Card",[r("p",{attrs:{slot:"title"},slot:"title"},[r("Icon",{attrs:{type:"md-settings"}}),e._v("\n        添加用户\n      ")],1),r("div",{staticClass:"edittable-testauto-con"},[r("Form",{ref:"userinfova",attrs:{model:e.userinfo,"label-width":80,rules:e.userinfoValidate}},[r("FormItem",{attrs:{label:"用户名",prop:"username"}},[r("Input",{attrs:{placeholder:"请输入"},model:{value:e.userinfo.username,callback:function(t){e.$set(e.userinfo,"username",t)},expression:"userinfo.username"}})],1),r("FormItem",{attrs:{label:"密码",prop:"password"}},[r("Input",{attrs:{placeholder:"请输入",type:"password"},model:{value:e.userinfo.password,callback:function(t){e.$set(e.userinfo,"password",t)},expression:"userinfo.password"}})],1),r("FormItem",{attrs:{label:"确认密码",prop:"confirmpassword"}},[r("Input",{attrs:{placeholder:"请输入",type:"password"},model:{value:e.userinfo.confirmpassword,callback:function(t){e.$set(e.userinfo,"confirmpassword",t)},expression:"userinfo.confirmpassword"}})],1),r("FormItem",{attrs:{label:"部门",prop:"department"}},[r("Input",{attrs:{placeholder:"请输入"},model:{value:e.userinfo.department,callback:function(t){e.$set(e.userinfo,"department",t)},expression:"userinfo.department"}})],1),r("FormItem",{attrs:{label:"姓名",prop:"realname"}},[r("Input",{attrs:{placeholder:"请输入"},model:{value:e.userinfo.realname,callback:function(t){e.$set(e.userinfo,"realname",t)},expression:"userinfo.realname"}})],1),r("FormItem",{attrs:{label:"角色",prop:"group"}},[r("Select",{attrs:{placeholder:"请选择"},model:{value:e.userinfo.group,callback:function(t){e.$set(e.userinfo,"group",t)},expression:"userinfo.group"}},[r("Option",{attrs:{value:"admin"}},[e._v("管理员")]),e.connectionList.multi?r("Option",{attrs:{value:"perform"}},[e._v("执行人")]):e._e(),r("Option",{attrs:{value:"guest"}},[e._v("使用人")])],1)],1),r("FormItem",{attrs:{label:"电子邮箱",prop:"email"}},[r("Input",{attrs:{placeholder:"请输入"},model:{value:e.userinfo.email,callback:function(t){e.$set(e.userinfo,"email",t)},expression:"userinfo.email"}})],1),r("Button",{staticStyle:{"margin-left":"35%"},attrs:{type:"primary",loading:e.loading},nativeOn:{click:function(t){return e.registered(t)}}},[e._v("注册")])],1)],1)])],1),r("Col",{staticClass:"padding-left-10",attrs:{span:"19"}},[r("Card",[r("p",{attrs:{slot:"title"},slot:"title"},[r("Icon",{attrs:{type:"md-people"}}),e._v("\n        系统用户表\n      ")],1),r("Input",{staticStyle:{width:"20%"},attrs:{placeholder:"请填写用户名",clearable:""},model:{value:e.query.user,callback:function(t){e.$set(e.query,"user",t)},expression:"query.user"}}),r("Input",{staticClass:"margin-left-10",staticStyle:{width:"20%"},attrs:{placeholder:"请填写部门",clearable:""},model:{value:e.query.department,callback:function(t){e.$set(e.query,"department",t)},expression:"query.department"}}),r("Button",{staticClass:"margin-left-10",attrs:{type:"primary"},on:{click:e.queryData}},[e._v("查询")]),r("Button",{staticClass:"margin-left-10",attrs:{type:"warning"},on:{click:e.queryCancel}},[e._v("重置")]),r("div",{staticClass:"edittable-con-1"},[r("Table",{attrs:{border:"",columns:e.columns,data:e.tableData,stripe:"",height:"520"},scopedSlots:e._u([{key:"action",fn:function(t){var a=t.row;return[1!==a.id?r("Button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.editPassModal(a)}}},[e._v("更改密码\n            ")]):e._e(),r("Button",{staticClass:"margin-left-10",attrs:{type:"info",size:"small"},on:{click:function(t){return e.editAuthModal(a)}}},[e._v("详细信息")]),"admin"!==a.Username?[r("Poptip",{attrs:{confirm:"",title:"确定删除改用户吗？",transfer:""},on:{"on-ok":function(t){return e.delUser(a)}}},[1!==a.id?r("Button",{staticClass:"margin-left-10",attrs:{type:"warning",size:"small"}},[e._v("删除")]):e._e()],1)]:e._e()]}}])})],1),r("br"),r("Page",{ref:"page",attrs:{total:e.pagenumber,"show-elevator":"","page-size":10},on:{"on-change":e.refreshUser}})],1)],1),r("edit_password",{attrs:{is_open:e.edit_password,username:e.username,is_admin:""},on:{cancel:e.cancel_password}}),r("Modal",{on:{"on-ok":e.saveAuthInfo},model:{value:e.editAuthForm.modal,callback:function(t){e.$set(e.editAuthForm,"modal",t)},expression:"editAuthForm.modal"}},[r("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[e._v("用户信息")]),r("Form",{attrs:{model:e.editAuthForm,"label-position":"right"}},[r("FormItem",{attrs:{label:"用户名"}},[r("Input",{attrs:{readonly:"readonly"},model:{value:e.editAuthForm.Username,callback:function(t){e.$set(e.editAuthForm,"Username",t)},expression:"editAuthForm.Username"}})],1),r("FormItem",{attrs:{label:"真实姓名"}},[r("Input",{model:{value:e.editAuthForm.RealName,callback:function(t){e.$set(e.editAuthForm,"RealName",t)},expression:"editAuthForm.RealName"}})],1),r("FormItem",{attrs:{label:"角色"}},[r("Select",{attrs:{placeholder:"请选择"},model:{value:e.editAuthForm.Rule,callback:function(t){e.$set(e.editAuthForm,"Rule",t)},expression:"editAuthForm.Rule"}},[r("Option",{attrs:{value:"admin"}},[e._v("管理员")]),e.connectionList.multi&&1!==e.editAuthForm.id?r("Option",{attrs:{value:"perform"}},[e._v("执行人")]):e._e(),1!==e.editAuthForm.id?r("Option",{attrs:{value:"guest"}},[e._v("使用者")]):e._e()],1)],1),r("FormItem",{attrs:{label:"部门"}},[r("Input",{attrs:{placeholder:"请输入新部门"},model:{value:e.editAuthForm.Department,callback:function(t){e.$set(e.editAuthForm,"Department",t)},expression:"editAuthForm.Department"}})],1),r("FormItem",{attrs:{label:"E-mail"}},[r("Input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.editAuthForm.Email,callback:function(t){e.$set(e.editAuthForm,"Email",t)},expression:"editAuthForm.Email"}})],1)],1)],1)],1)},s=[],o=r("bc3a"),n=r.n(o),i=r("e4fc"),l=(r("a32f"),r("09f7")),u={mixins:[i["b"]],components:{edit_password:l["a"]},data:function(){var e=this,t=function(t,r,a){r!==e.userinfo.password?a(new Error("两次输入密码不一致")):a()},r=function(t,r,a){var s=/^.*(?=.{6,})(?=.*\d)(?=.*[A-Z])(?=.*[a-z]).*$/;s.test(e.userinfo.password)?a():a(new Error("至少1个大写字母,1个小写字母,1个数字"))};return{query:{user:"",department:"",valve:!1},loading:!1,columns:[{title:"用户名",key:"Username",sortable:!0},{title:"角色",key:"Rule",sortable:!0},{title:"姓名",key:"RealName",sortable:!0},{title:"部门",key:"Department",sortable:!0},{title:"email",key:"Email",sortable:!0},{title:"操作",key:"action",width:250,align:"center",slot:"action"}],tableData:[],pagenumber:1,userinfo:{username:"",password:"",confirmpassword:"",group:"",checkbox:"",department:"",email:"",realname:""},userinfoValidate:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"请至少输入6个字符",trigger:"blur"},{max:32,message:"最多输入32个字符",trigger:"blur"},{validator:r,trigger:"blur"}],confirmpassword:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:t,trigger:"blur"}],group:[{required:!0,message:"请输入权限",trigger:"blur"}],department:[{required:!0,message:"请输入部门名称",trigger:"blur"},{min:2,message:"请至少输入6个字符",trigger:"blur"},{max:32,message:"最多输入32个字符",trigger:"blur"}],realname:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,message:"请至少输入2个字符",trigger:"blur"},{max:32,message:"最多输入32个字符",trigger:"blur"}],email:[{required:!0,message:"请输入工作邮箱",trigger:"blur"},{min:2,message:"请至少输入2个字符",trigger:"blur"},{max:32,message:"最多输入32个字符",trigger:"blur"}]},GroupModal:!1,editAuthForm:{Username:"",Department:"",RealName:"",Rule:"",Email:"",modal:!1},username:"",connectionList:{multi:Boolean}}},methods:{editPassModal:function(e){this.username=e.Username,this.edit_password=!0},editAuthModal:function(e){this.editAuthForm=this.$config.sameMerge(this.editAuthForm,e,this.editAuthForm),this.editAuthForm.modal=!0},saveAuthInfo:function(){var e=this;this.savePassLoading=!0,n.a.post("".concat(this.$config.url,"/management_user/modify"),{Username:this.editAuthForm.Username,Rule:this.editAuthForm.Rule,Department:this.editAuthForm.Department,RealName:this.editAuthForm.RealName,Email:this.editAuthForm.Email}).then((function(t){e.$config.notice(t.data),e.$config.clearObj(e.editAuthForm),e.refreshUser(e.$refs.page.currentPage)})).catch((function(t){e.$config.err_notice(e,t)})),this.savePassLoading=!1},registered:function(){var e=this;this.$refs["userinfova"].validate((function(t){t&&(e.loading=!0,n.a.post("".concat(e.$config.url,"/management_user/register"),{userinfo:e.userinfo}).then((function(t){e.loading=!1,e.$config.notice(t.data),e.refreshUser(e.$refs.page.currentPage),e.userinfo=e.$config.clearObj(e.userinfo)})).catch((function(t){e.loading=!1,e.$config.err_notice(e,t)})))}))},refreshUser:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;n.a.get("".concat(this.$config.url,"/management_user/fetch?page=").concat(t,"&con=").concat(JSON.stringify(this.query))).then((function(t){e.connectionList.multi=t.data.multi,e.tableData=t.data.data,e.pagenumber=parseInt(t.data.page)})).catch((function(t){e.$config.err_notice(e,t)}))},delUser:function(e){var t=this,r=this.$refs.page.currentPage;1===this.tableData.length&&(r-=1),n.a.delete("".concat(this.$config.url,"/management_user/del/").concat(e.Username)).then((function(e){t.$config.notice(e.data),t.refreshUser(r)})).catch((function(e){t.$config.err_notice(t,e)}))},queryData:function(){this.query.valve=!0,this.refreshUser()},queryCancel:function(){this.$config.clearObj(this.query),this.refreshUser()}},mounted:function(){this.refreshUser()}},c=u,m=(r("4fb4"),r("2877")),d=Object(m["a"])(c,a,s,!1,null,"384941d4",null);t["default"]=d.exports},8713:function(e,t,r){},a32f:function(e,t,r){},e4fc:function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return s}));var a={data:function(){return{edit_password:!1,savePassLoading:!1}},methods:{cancel_password:function(){this.edit_password=!1}}},s={data:function(){return{is_open:!1,group_list:[],group_props:[]}}}}}]);
//# sourceMappingURL=chunk-4e66b9cf.ba0fec27.js.map