(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-eaaaba94"],{"0a49":function(t,e,r){var n=r("9b43"),a=r("626a"),o=r("4bf8"),i=r("9def"),s=r("cd1c");t.exports=function(t,e){var r=1==t,c=2==t,l=3==t,u=4==t,f=6==t,p=5==t||f,d=e||s;return function(e,s,m){for(var h,y,g=o(e),_=a(g),k=n(s,m,3),v=i(_.length),b=0,x=r?d(e,v):c?d(e,0):void 0;v>b;b++)if((p||b in _)&&(h=_[b],y=k(h,b,g),t))if(r)x[b]=y;else if(y)switch(t){case 3:return!0;case 5:return h;case 6:return b;case 2:x.push(h)}else if(u)return!1;return f?-1:l||u?u:x}}},7514:function(t,e,r){"use strict";var n=r("5ca1"),a=r("0a49")(5),o="find",i=!0;o in[]&&Array(1)[o]((function(){i=!1})),n(n.P+n.F*i,"Array",{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(o)},"96bf":function(t,e,r){"use strict";r("c518")},b56e:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Row",[r("Card",[r("p",{attrs:{slot:"title"},slot:"title"},[r("Icon",{attrs:{type:"md-person"}}),t._v("\n        我的工单\n      ")],1),r("Form",{ref:"queryForm",attrs:{inline:""}},[r("FormItem",[r("Input",{attrs:{placeholder:"工单说明"},on:{"on-keyup":function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.queryData(e)}},model:{value:t.find.text,callback:function(e){t.$set(t.find,"text",e)},expression:"find.text"}})],1),r("FormItem",[r("DatePicker",{staticStyle:{width:"250px"},attrs:{format:"yyyy-MM-dd HH:mm",type:"datetimerange",placeholder:"请选择查询的时间范围",editable:!1},on:{"on-change":function(e){t.find.picker=e}},model:{value:t.find.picker,callback:function(e){t.$set(t.find,"picker",e)},expression:"find.picker"}})],1),r("FormItem",[r("Button",{attrs:{type:"success"},on:{click:t.queryData}},[t._v("查询")])],1),r("FormItem",[r("Button",{attrs:{type:"primary"},on:{click:t.queryCancel}},[t._v("重置")])],1)],1),r("Row",[r("Col",{attrs:{span:"24"}},[r("Table",{attrs:{border:"",columns:t.columnsName,data:t.table_data,stripe:"",size:"small"},scopedSlots:t._u([{key:"action",fn:function(e){var n=e.row;return[r("Button",{staticClass:"margin-left-10",attrs:{type:"success",size:"small",ghost:""},on:{click:function(e){return t.open_modal(n)}}},[t._v("\n                工单信息\n              ")]),2!==n.Status&&0!==n.Status?r("Button",{staticClass:"margin-left-10",attrs:{type:"warning",size:"small",ghost:""},on:{click:function(e){return t.openOrder(n)}}},[t._v("\n                执行信息\n              ")]):t._e(),r("Poptip",{attrs:{confirm:"",title:"确定要撤销工单吗？",transfer:""},on:{"on-ok":function(e){return t.delOrder(n)}}},[2===n.Status?r("Button",{staticClass:"margin-left-10",attrs:{type:"primary",ghost:"",size:"small"}},[t._v("工单撤销")]):t._e()],1),0===n.Status?r("Button",{staticClass:"margin-left-10",attrs:{type:"error",size:"small",ghost:""},on:{click:function(e){return t.orderReject(n)}}},[t._v("驳回理由\n              ")]):t._e()]}}])})],1)],1),r("br"),r("Page",{ref:"page",attrs:{total:t.page_number,"show-elevator":"","page-size":20},on:{"on-change":t.currentpage}})],1)],1),r("Modal",{attrs:{width:"1000"},model:{value:t.openModal,callback:function(e){t.openModal=e},expression:"openModal"}},[r("p",{staticStyle:{color:"#f60","font-size":"16px"},attrs:{slot:"header"},slot:"header"},[r("Icon",{attrs:{type:"information-circled"}}),r("span",[t._v("SQL工单详细信息")])],1),r("Form",{attrs:{"label-position":"right"}},[r("FormItem",{attrs:{label:"环境:"}},[r("span",[t._v(t._s(t.formitem.IDC))])]),r("FormItem",{attrs:{label:"连接名称:"}},[r("span",[t._v(t._s(t.formitem.Source))])]),r("FormItem",{attrs:{label:"数据库库名:"}},[r("span",[t._v(t._s(t.formitem.DataBase))])]),r("FormItem",{attrs:{label:"数据库表名:"}},[r("span",[t._v(t._s(t.formitem.Table))])]),r("FormItem",{attrs:{label:"定时执行:"}},[r("span",[t._v(t._s(t.formitem.Delay))])]),r("FormItem",{attrs:{label:"工单说明:"}},[r("span",[t._v(t._s(t.formitem.Text))])]),r("FormItem",[r("Table",{attrs:{columns:t.sql_columns,data:t.sql,"max-height":300}})],1)],1)],1),r("Modal",{model:{value:t.reject,callback:function(e){t.reject=e},expression:"reject"}},[r("p",{staticStyle:{color:"#ff0049","font-size":"16px"},attrs:{slot:"header"},slot:"header"},[r("Icon",{attrs:{type:"information-circled"}}),r("span",[t._v("驳回理由")])],1),r("p",{staticStyle:{"font-size":"16px"}},[t._v(t._s(t.reject_text))])])],1)},a=[],o=(r("ac6a"),r("7514"),r("bc3a")),i=r.n(o),s={name:"put",data:function(){return{reject:!1,openModal:!1,columnsName:[{title:"工单编号:",key:"WorkId",sortable:!0},{title:"工单说明",key:"Text",tooltip:!0},{title:"是否备份",key:"Backup"},{title:"提交时间:",key:"Date",sortable:!0},{title:"审核/执行人",key:"Assigned",sortable:!0},{title:"多级审核执行人",key:"Executor",sortable:!0},{title:"状态",key:"Status",render:function(t,e){var r=e.row,n="",a="";return 2===r.Status?(n="primary",a="待审核"):0===r.Status?(n="error",a="驳回"):1===r.Status?(n="success",a="已执行"):4===r.Status?(n="error",a="执行失败"):5===r.Status?(n="primary",a="待执行"):(n="warning",a="执行中"),t("Tag",{props:{type:"dot",color:n}},a)},sortable:!0},{title:"操作",key:"action",align:"center",slot:"action",width:250}],reject_text:"",page_number:1,computer_room:this.$config.computer_room,table_data:[],find:{picker:[],valve:!1,text:""},multi:!1,formitem:{},sql:[],sql_columns:[{title:"sql",key:"SQL"}]}},methods:{open_modal:function(t){var e=this;i.a.get("".concat(this.$config.url,"/fetch/sql?k=").concat(t.WorkId)).then((function(t){e.sql=t.data})).catch((function(t){return e.$config.err_notice(e,t)})),this.openModal=!0,this.formitem=t},currentpage:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;i.a.put("".concat(this.$config.url,"/user/order"),{page:e,find:this.find}).then((function(e){if(!e.data.multi)for(var r=0;r<t.columnsName.length;r++)"Executor"===t.columnsName[r].key&&t.columnsName.splice(r,1);t.table_data=e.data.data,t.table_data.forEach((function(t){1===t.Backup?t.Backup="是":t.Backup="否"})),t.page_number=parseInt(e.data.page)})).catch((function(e){t.$config.err_notice(t,e)}))},queryData:function(){this.find.valve=!0,this.currentpage()},queryCancel:function(){this.find=this.$config.clearPicker(this.find),this.$refs.page.currentPage=1,this.currentpage()},openOrder:function(t){this.$router.push({name:"orderlist",query:{workid:t.WorkId,status:t.Status}})},orderReject:function(t){this.reject=!0,this.reject_text=t.Rejected},delOrder:function(t){var e=this;i.a.get("".concat(this.$config.url,"/fetch/undo?work_id=").concat(t.WorkId)).then((function(t){e.$config.notice(t.data),e.currentpage(e.$refs.page.currentPage)})).catch((function(t){e.$config.err_notice(e,t)}))}},mounted:function(){this.currentpage()}},c=s,l=(r("96bf"),r("2877")),u=Object(l["a"])(c,n,a,!1,null,null,null);e["default"]=u.exports},c518:function(t,e,r){},cd1c:function(t,e,r){var n=r("e853");t.exports=function(t,e){return new(n(t))(e)}},e853:function(t,e,r){var n=r("d3f4"),a=r("1169"),o=r("2b4c")("species");t.exports=function(t){var e;return a(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!a(e.prototype)||(e=void 0),n(e)&&(e=e[o],null===e&&(e=void 0))),void 0===e?Array:e}}}]);
//# sourceMappingURL=chunk-eaaaba94.7d46a2f4.js.map